---
title: "Untitled"
author: Xiao Bai
date: 6 Feburary 2022
subtitle:
output:
  pdf_document: default
  html_document: default
---
# Abstract








# Introduction

People's demand for rental accommodation in Toronto has increase significantly in recent years. Although there have not been many new apartment buildings built in the last few decades and the existing apartment buildings are not as numerous as you might think in downtown Toronto, the demand for renting an apartment still keep increasing to some extent. At the same time, a report by Toronto Regional Real Estate Board states the amount of rental apartments that were leased this year doubled than last year (https://www.narcity.com/toronto/torontos-rental-market-is-wild-but-heres-how-to-rent-that-dream-apartment). Moreover, as there was a substantial increase of immigration and student population into the GTA area, this trend appears to continue rising to the next year (https://trreb.ca/files/news_releases/news2021/nr_rental_report_Q2-2021.pdf). This phenomena indicates that as a new person who has recently come to Toronto and want to find an accommodation to stay, they may face the problem of choosing an appropriate apartment building from this substantial amount of options. Therefore, it is somehow necessary to understand the current different types of apartment buildings so that new coming tenant can have a better idea of what kind of apartment is the most appropriate one for them. However, there are many factors that may vary a building's characteristics(quality) such as different number of stories and units, and each person's preference for different types can also be not the same as each other. For example, some people tend to live in an apartment where there are only few units in each floor while others may prefer to live in a relatively tall building as they can enjoy the scenery outside the window. Thus, for this report, I will only consider factors that I think are essential for a tenant to know before they move in. Based on that, this report will mainly focus on the time (in years) that each building was built and the variation of facilities of different buildings in different constructed years. Specifically, I will compare buildings' installation status for four different types of facilities: heating equipment, number of stories, number of units, as well as visitor parking. Finally, I will discuss the statistical bias or limitation of this dataset.

The analysis will be conducted in R(R Core Team 2020), and the packages we will use are dplyr (Wickham et al. 2021), tidyverse (Wickham et al. 2019). All graphs will be created using function ggplot2 (Wickham 2016) and knitr(Xie,2021) will be applied in tables.






```{r setup, include=FALSE}
#install.packages("tidyverse")
#install.packages("opendatatoronto")
#install.packages("tidyr")
library("tidyverse")
library(tidyr)
library(opendatatoronto)
library(dplyr)
library(janitor)
package <- show_package("2b98b3f3-4f3a-42a4-a4e9-b44d3026595a")
package
resources <- list_package_resources("2b98b3f3-4f3a-42a4-a4e9-b44d3026595a")
datastore_resources <- filter(resources, tolower(format) %in% c('csv', 'geojson'))
data <- filter(datastore_resources, row_number()==1) %>% get_resource()
write.csv(
  x = data, 
  file = "Apartment Building Registration"
  )

```
# Data

## *Data Collection and Characteristics*
The dataset is collected from Open Data Toronto and it contains information about Toronto's current building information. Open Data Toronto is a digital data that is initiative by the City of Toronto government and it is made available with the technical characteristics necessary for it to be freely used (Open data Toronto). It provides a variety of tabular datasets relating to the city's services, infraustructions and development. There are more than ten different data categories in this portal, and the data that will be used in this paper relates to the information of Toronto's apartment building which was constructed between the year 1805 and 2021. Specifically, each apartment's information was first collected from building owners, and then those information was registered and uploaded to the city's program for further use. In addition, the building information will be renewed annually to keep the most up-to-date dataset (Open Data Toronto). There are 3488 observations and 70 variables in the dataset. Most of variables are categorical and only ten of them are numerical variables. Categorical variables are about facility status in a building, in other words, it shows whether a building's common facilities, open areas or all other equipment are installed properly in that building. Numerical variables show the exact number of facilities such as the number of units or stories. In this analysis, I will use seven variables and provide a general understanding of Toronto's accommodation condition to give new coming tenants a better way of choosing their preferred apartments. With other variables that we are not interested in, they are removed and a sample view of original dataset is displayed below.


## *Apartment Building Counts and Heating Equipment Status*

Although commenting the qualification of a building or deciding whether this building has a good living environment depends on many factors, one essential way is to analyze based on each building's age. Therefore, the first step is to find out the year that each building was built and then count the number of apartment buildings according to years. However, as it can be distracted to list all years and its corresponding number of buildings, a more clear way is to classify based on year periods. By doing so, a new variable named "year-built_new1" was created, and it simply groups each year that building was built to five different intervals. Figure 1 displays the total number of buildings constructed during specific year period. Note that the year refers to the year that buildings were built, and does not necessarily indicate the year the building owners registered to the City's program. Based on the figure, we can see that the number of buildings that were built during year between 1950 to 1975 accounts for the highest (>1500) among all five periods while there are very few apartments constructed before 1950. It is not unexpected because the Great Depression happened during the period between 1930 and 1940. According to Struthers ( https://www.thecanadianencyclopedia.ca/en/article/great-depression#), the world's population growth reached the lowest point during 1930s, and at the same time, Canada's population in urban area grew even less significant than rural area. This Great Depression caused Canada's economy drop dramatically, which seems a reason to illustrate why only few buildings were constructed at that time. After 1940, the economy began recovering, and it took approximetly eight years for the world's economy to recover back to normal (https://en.wikipedia.org/wiki/Great_Depression#Turning_point_and_recovery). This can be a potential reason that a short economy boom after the Great depression caused more buildings built during 1950-1975.




```{r cars}
apartment_building <- read.csv(file="Apartment Building Registration")

apartment_cleaned =apartment_building %>%
  select(HEATING_EQUIPMENT_STATUS,YEAR_BUILT,HEATING_EQUIPMENT_YEAR_INSTALLED,CONFIRMED_STOREYS,CONFIRMED_UNITS,GARBAGE_CHUTES,VISITOR_PARKING) %>%
  arrange(YEAR_BUILT)%>%
  filter(HEATING_EQUIPMENT_YEAR_INSTALLED>YEAR_BUILT)%>%
  mutate(year_built_new1 =
           case_when(
             YEAR_BUILT < 1900 ~ "<1900",
             YEAR_BUILT <= 1925 ~ "1900-1925",
             YEAR_BUILT <= 1950 ~ "1925-1950",
             YEAR_BUILT <= 1975 ~ "1950-1975",
             TRUE ~ "1975<"),
         year_built_new2 =
           case_when(
             (YEAR_BUILT < 1955) & (YEAR_BUILT >= 1950) ~ "1950-1955",
             (YEAR_BUILT < 1960) & (YEAR_BUILT >= 1955) ~ "1955-1960",
             (YEAR_BUILT < 1965) & (YEAR_BUILT >= 1960) ~ "1960-1965",
             (YEAR_BUILT < 1970) & (YEAR_BUILT >= 1965) ~ "1965-1970",
             (YEAR_BUILT < 1975) & (YEAR_BUILT >= 1970) ~ "1970-1975",
             
             
             TRUE ~ "useless"))


apartment_cleaned %>%
  ggplot(mapping = aes(x = year_built_new1))+geom_bar()+ theme_minimal()
  
```

```{r}
apartment_cleaned %>%
  filter(year_built_new2 != "useless")%>%
  ggplot(mapping = aes(x = year_built_new2, fill = HEATING_EQUIPMENT_STATUS))+
  geom_bar()+theme_minimal()+
  labs(x = "Year",
       y = "Number of Apartment Building",
       fill = "Heating Equipment Status ",
       title = "Distribution of the number of apartment buildings and heating equipment status during 1950-1980",
       caption = "Source: xxxxxxxx")+
  scale_fill_brewer()

```
In addition, as we have figured out that most buildings in Toronto were constructed in the period 1950-1975, it would be better to see qualification of those buildings which were built in this time. The variable HEATING_EQUIPMENT_STATUS is then used and it states whether the heating equipment is original or replaced. Figure 2 shows the total number of heating equipment replaced and total number equipment that were not replaced for the period where buildings were built between 1950 and 1975. To make the graph more clear, I also divide the whole period into five short periods. Based on the graph, we can see a slight gradual increase in the number of apartment building registered to the City's program between the years 1950 and 1965, followed by a drop in the number of buildings in the next 10 years. Moreover, most of buildings built between 1970 and 1975 were replaced while % percent of buildings' heating equipment have still not replaced during the first five years period. The other three time periods have approximately the same percentage of replaced heating equipment in their buildings. It is necessary that a living place has an advanced heating system to increase new tenants' satisfaction. Moreover, the old heating equipment can also be harmful to one's heath as well as the environment. According to.... Therefore, this figure can be a reference for those who are willing to rent a new apartment and do not know the difference between buildings built at different periods. However, this figure might not be useful for people who tend to see which year has the most number of heating system replaced as all five periods appear to show the same amount of percentage.

Figure 3 shows the frequency of the number of years it takes for a heating system to be installed after the building was built. In other words, some building managers were less likely to install a heating system right after the building was constructed completely. For some reason, they tend to have heating equipment installed a few years after that. Therefore, in this time, I calculate the time between installed equipment and building was built. The x-axis indicates that there was no heating equipment in this building until x years after, and y-axis shows the number of buildings. In the figure, we can notice that during the first 25 years (1900-1925), the average time it takes for a heating system to be installed is around 90 years, however, the time became shorter over time. Buildings built after 1975 have a mean installing time only about 23 years. This result reveals that new buildings are more likely to have heating system established as soon as building has completed its construction.


```{r}
apartment_cleaned2 =apartment_cleaned  %>%
  mutate(built_difference = HEATING_EQUIPMENT_YEAR_INSTALLED - YEAR_BUILT)


apartment_cleaned2%>%
  ggplot(mapping = aes(x = built_difference, color =year_built_new1 )) +
  geom_freqpoly(binwidth = 10)+
  labs(x = "Number of years heating equipment installed after building was built",
       y = "Density",
       title = "Number of years for heating equipment installed given different years",
       color = "Year intervals",
       caption = "xxxxxx.")

apartment_cleaned3 = apartment_cleaned2 %>%
  group_by(year_built_new1)%>%
  summarise(n(),mean_difference = mean(built_difference))
apartment_cleaned3

```
## *Story, Unit and Garbage Chute Counts*

Another way to rent appropriate apartment buildings is based on tenant's preference on the number of stories and units. By doing so, I calculate the average number of stories and units according for buildings built before and after year 1950. The summary table 1 below shows that within 1827 buildings that were constructed after 1950, the mean number of story is 7.866995 while the average unit is 89.72797. Compare to buildings established after 1950, buildings that were constructed before 1950 has a mean number of 3.685328 stories and 27.57915 units. Therefore, if someone wants to live in a place has less floors and units, then it would be better to choose an old building instead of newer one. However, if one cares more about whether there is a garbage chute in their floor, then it can be a better choice to choose buildings after 1950 since the proportion of buildings established before 1950 that has a garbage chute is only 7.34% compared to those established after 1950 (46.09%).





```{r}
apartment_cleaned4 = apartment_cleaned %>%
  mutate(year_built_new3 = case_when(
    YEAR_BUILT <= 1950 ~ "Before 1950",
    TRUE ~ "After 1950"
  )) %>%
  filter(!is.na(GARBAGE_CHUTES))%>%
  group_by(year_built_new3) %>%
  summarise(n(), mean_story = mean(CONFIRMED_STOREYS), mean_units = mean(CONFIRMED_UNITS), pro_gar_chutes = sum(GARBAGE_CHUTES == 'YES')/n())
apartment_cleaned4
```
## *Visitor Parking Status*

The "VISITOR_PARKING" variable in the dataset refers to the visitor parking category in a building, and the four types can be a reference for new tenant to decide if those buildings are appropriate for them. Figure 4 displays the total number of buildings given different types of visitor parking and year. The number of different types appear to vary by different year. We can see that between the year 1950 and 1975, % of visitor parking is free for tenant and % is unavailable. By contrast, a large proportion of building constructed during year 1925 and 1950 has no visitor parking, with only a small percentage of buildings have either free parking space or paid one. 

```{r}
apartment_cleaned %>%
  filter(!is.na(VISITOR_PARKING))%>%
  ggplot(mapping = aes(x = year_built_new1, fill = VISITOR_PARKING))+
  geom_bar(position = "dodge")+theme_minimal()+
  labs(x = "Year",
       y = "Number of Apartment Building",
       fill = "Heating Equipment Status ",
       title = "Distribution of the number of apartment buildings and heating equipment status during 1950-1980",
       caption = "Source: xxxxxxxx")+
  scale_fill_brewer(palette = "Greens")+
  coord_flip()
```
## *Limitation*

The statistical bias is also obvious. Since the dataset only contains information of buildings that were registered to Apartment Building Standard (ABS) program, we miss information of those which have still not registered. This can make the result less accurate as those missing data were not included to our analysis. Similarly, as this information was collected from building owners/managers during the initial registration process, there may be a potential risk that information provided by them may not be as reliable as we expected. Furthermore, analyzing this data can only give us a better understanding of current Toronto apartment buildings' phenomenon, and it is hard to make a prediction or identifying future trend from this data. For example, predicting the probability that the number of buildings will have a free visitor parking in the future might not be achieved. Moreover, the reason of why some of old buildings still have not replaced their heating equipment is not clear and may depend on many other factors.

After the year of 1975, we can see only few new apartment buildings were built as many condos in Toronto were established instead. Since a condo is more likely to be built at the city's best location and renting a condo brings lots of advantages, so the demand for condo increase significantly. 


# References








